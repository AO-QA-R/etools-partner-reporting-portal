{% extends "easy_pdf/base.html" %}
{% load pdf_extras %}

{% block extra_style %}
    <style type="text/css">
        @page {
            size: a4 landscape;
            margin: 1cm;
        }

        #pdf {
            font-family: "Arial", "sans-serif";
            font-size: 10px;
        }
        h1 {
            font-family: "Arial", "sans-serif";
            font-size: 11px;
            font-weight: bold;
        }
        table, td, th {
            border: 1px solid black;
        }
        td, th {
            padding-top: 4px;
            padding-bottom: 1px;
            padding-left: 3px;
        }
        th {
            background-color: #d9d9d9;
            font-weight: normal;
            text-align: left;
        }
        th.section {
            background-color: #002060;
            font-weight: bold;
            color: #ffffff;
            text-align: left;
        }
        td.signature {
            font-size: 12px;
            font-weight: bold;
        }

        td.Met {
            background-color: #FFFFFF;
        }

        td.OnT {
            background-color: #92D050;
        }

        td.NoP {
            background-color: #E93F33;
        }

        td.Con {
            background-color: #B2A1C7;
        }

    </style>
{% endblock %}

{% block content %}
    <div id="pdf">
        <h1>PART 2: programme progress/final report - to be completed by CSO as part of reporting with FACE</h1>
        <table>
            <tr>
                <th colspan="4" class="section">Section 1. Programme & CSO overview</th>
            </tr>
            <tr>
                <th rowspan="3" width="40%">
                    1.1 Programme reference
                </th>
                <th width="40%">
                    UNICEF Office
                </th>
                <td colspan="2">
                    {{ unicef_office }}
                </td>
            </tr>
            <tr>
                <th>
                    Progr. Title
                </th>
                <td colspan="2">
                    {{ title }}
                </td>
            </tr>
            <tr>
                <th>PD/SSFA Ref. #</th>
                <td colspan="2">{{ reference_number }}</td>
            </tr>
            <tr>
                <th rowspan="9">
                    1.2 Organization information
                </th>
                <th>Organization / Acronym</th>
                <td colspan="2">{{ partner.title }} / {{ partner.short_title }}</td>
            </tr>
            <tr>
                <th>Name of CSO Authorized Official</th>
                <td colspan="2">{{ authorized_officer.name }}</td>
            </tr>
            <tr>
                <th>Title of Authorized Official</th>
                <td colspan="2">{{ authorized_officer.title }}</td>
            </tr>
            <tr>
                <th>Email of Authorized Official</th>
                <td colspan="2">{{ authorized_officer.email }}</td>
            </tr>
            <tr>
                <th>Phone of Authorized Official</th>
                <td colspan="2">{{ authorized_officer.phone_number }}</td>
            </tr>
            <tr>
                <th>Name of Programme Focal Point</th>
                <td colspan="2">{{ focal_point.name }}</td>
            </tr>
            <tr>
                <th>Title</th>
                <td colspan="2">{{ focal_point.title }}</td>
            </tr>
            <tr>
                <th>Email</th>
                <td colspan="2">{{ focal_point.email }}</td>
            </tr>
            <tr>
                <th>Telephone</th>
                <td colspan="2">{{ focal_point.phone_number }}1</td>
            </tr>
            <tr>
                <th rowspan="3">
                    1.3 Programme information
                </th>
                <th>Progr. Duration</th>
                <td colspan="2">From {{ start_date }} to {{ end_date }}</td>
            </tr>
            <tr>
                <th>Start date</th>
                <td colspan="2">{{ start_date }}</td>
            </tr>
            <tr>
                <th>Reporting period</th>
                <td colspan="2">{{ reporting_period }}</td>
            </tr>
            <tr>
                <th rowspan="3">1.4 Budget information</th>
                <th>Programme budget</th>
                <td colspan="2">{{pd.get_cso_contribution_currency_display}}{{ cso_contribution }}</td>
            </tr>
            <tr>
                <th>UNICEF contribution</th>
                <td colspan="2">{{pd.get_budget_currency_display}}{{ budget }}</td>
            </tr>
            <tr>
                <th>Funds received to date</th>
                <td>{{pd.get_funds_received_to_date_currency_display}}{{ funds_received_to_date }}</td>
                <td>100% to date</td>
            </tr>
            <tr>
                <th>1.5 Partner Contribution made to date</th>
                <td colspan="3">{{ partner_contribution_to_date }}</td>
            </tr>
            <tr>
                <th>1.6 Signature of CSO Authorized Official</th>
                <td class="signature">{{ authorized_officer.name }}</td>
                <td colspan="2">Date: {{ submission_date|default:"---" }}</td>
            </tr>
        </table>

        <!--TEMPORARY-->
        <div>
            <pdf:nextpage />
        </div>

        <table>
            <tr>
                <th class="section">2. Reporting on results achieved</th>
            </tr>
            <tr>
                <td>The table below provides an overview of results achieved during the reporting period and cumulatively since the onset of the programme.</td>
            </tr>
        </table>
        <br /><br />
        <table>
            <tr>
                <th>Programme Outputs*</th>
                <th>Performance indicator*</th>
                <th>Targets*</th>
                <th>Achievement in reporting period**</th>
                <th>Cumulative progress to date**</th>
                <th>Overall Status</th>
                <th>Narrative assessment/ summary of progress**</th>
            </tr>

            <!--This is probably loop -->
            {% for output in outputs %}
                {% for indicator in output %}
                    {% if forloop.counter == 1 %}
                        <tr>
                            <th rowspan="{{ output|length }}">{{ indicator.reportable.blueprint.title }}</th>
                            <th>{{ indicator.title }}</th>
                            <th>{{ indicator.reportable.target }}</th>
                            <td width="100px">{% if indicator.is_number %}{{ indicator.total.v|floatformat:"0" }}{% else %}{{ indicator.total.c|percentage }}{% endif %}</td>
                            <td width="100px">{% if indicator.is_number %}{{ indicator.total.v|floatformat:"0" }}{% else %}{{ indicator.total.c|percentage }}{% endif %}</td>
                            <td class="{{ indicator.overall_status }}" rowspan="{{ output|length }}">{{ indicator.get_overall_status_display }}</td>
                            <td rowspan="{{ output|length }}">{{ indicator.narrative_assessment|default:"---" }}</td>
                        </tr>
                    {% else %}
                        <tr>
                            <th>{{ indicator.title }}</th>
                            <th>{{ indicator.reportable.target }}</th>
                            <td>{% if indicator.is_number %}{{ indicator.total.v|floatformat:"0" }}{% else %}{{ indicator.total.c|percentage }}{% endif %}</td>
                            <td>{% if indicator.is_number %}{{ indicator.total.v|floatformat:"0" }}{% else %}{{ indicator.total.c|percentage }}{% endif %}</td>
                        </tr>
                    {% endif %}
                {% endfor %}
            {% endfor %}
            <!--End of loop-->

            <tr>
                <th>Challenges / bottlenecks faced in the reporting period</th>
                <td colspan="6">{{ challenges_in_the_reporting_period }}</td>
            </tr>
            <tr>
                <th>Proposed way forward</th>
                <td colspan="6">{{ proposed_way_forward }}</td>
            </tr>
        </table>
        <br />
        <p>
            * Information directly extracted from Section 2.2 of the signed Programme document.<br />
            ** Information to be updated upon submission of the report.
        </p>
    </div>
{% endblock %}
