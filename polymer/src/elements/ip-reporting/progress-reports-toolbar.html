<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../../bower_components/iron-location/iron-location.html">

<link rel="import" href="../../endpoints.html">
<link rel="import" href="../../redux/store.html">
<link rel="import" href="../../styles/buttons.html">

<dom-module id="progress-reports-toolbar">
  <template>
    <style include="iron-flex iron-flex-reverse button-styles">
      :host {
        display: block;
        margin: 1em 0;
      }

      a {
        text-decoration: none;
        color: var(--theme-primary-color);
      }
    </style>

    <iron-location
      query="{{query}}">
    </iron-location>

    <div class="layout horizontal-reverse">
      <a
          href="[[xlsExportUrl]]"
          tabindex="-1"
          target="_blank">
        <paper-button class="btn-primary">
          <iron-icon icon="icons:file-download"></iron-icon>
          XLS
        </paper-button>
      </a>
  </template>

  <script>
    Polymer({
      is: 'progress-reports-toolbar',

      behaviors: [
        App.Behaviors.ReduxBehavior,
      ],

      properties: {
        query: String,

        locationId: {
          type: String,
          statePath: 'location.id',
        },

        xlsExportUrl: {
          type: String,
          computed: '_computeExportUrl(locationId, query, "xlsx")',
        },

      },

      _computeExportUrl: function (locationId, query, filetype) {
        return [
          App.Endpoints.programmeDocumentReports(locationId),
          '?',
          query,
          '&export=',
          filetype
        ].join('');
      },
    });
  </script>
</dom-module>
