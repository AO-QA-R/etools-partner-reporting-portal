<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/iron-localstorage/iron-localstorage.html">

<link rel="import" href="../redux/redux-store.html">
<link rel="import" href="../redux/actions.html">

<dom-module id="etools-prp-auth">
  <template>

    <iron-localstorage
        id="storage"
        name="token"
        value="[[token]]"></iron-localstorage>
  </template>

  <script>
    (function () {
      Polymer({
        is: 'etools-prp-auth',

        behaviors: [
          App.Behaviors.ReduxBehavior,
        ],

        properties: {
          token: {
            type: String,
            statePath: 'auth.token',
          },
        },

        attached: function () {
          // Use saved token, if present
          var savedToken = this.$.storage.value;

          if (savedToken && !this.token) {
            this.dispatch(App.Actions.setToken(savedToken));
          }
        },
      });
    }());
  </script>
</dom-module>
