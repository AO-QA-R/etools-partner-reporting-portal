<link rel="import" href="../../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../../bower_components/iron-location/iron-location.html">
<link rel="import" href="../../../../bower_components/iron-location/iron-query-params.html">

<link rel="import" href="../../../settings.html">
<link rel="import" href="../../../behaviors/filter-dependencies.html">
<link rel="import" href="../dropdown-filter/dropdown-filter.html">

<dom-module id="narrow-location-type-filter">
  <template>
    <style>
      :host {
        display: block;
      }
    </style>

    <iron-location
        query="{{query}}">
    </iron-location>

    <iron-query-params
        params-string="{{query}}"
        params-object="{{queryParams}}">
    </iron-query-params>

    <dropdown-filter
        label="Narrow Location Type"
        name="narrow_loc_type"
        value="[[value]]"
        data="[[data]]"
        disabled="[[disabled]]">
    </dropdown-filter>
  </template>

  <script>
    Polymer({
      is: 'narrow-location-type-filter',

      behaviors: [
        App.Behaviors.FilterDependenciesBehavior,
      ],

      properties: {
        data: {
          type: Array,
          computed: '_computeData(params, maxLocType)',
        },

        maxLocType: {
          type: Number,
          value: App.Settings.cluster.maxLocType,
        },

        disabled: {
          type: Boolean,
          computed: '_computeDisabled(data)',
        },

        value: String,
      },

      _computeData: function (params, maxLocType) {
        return Array.apply(null, Array(maxLocType))
            .map(function (_, index) {
              var id = index + 1;

              return {
                id: String(id),

                title: id === maxLocType ?
                    'Admin' + id :
                    ['Admin' + id, 'Admin' + maxLocType].join(' - '),
              };
            })
            .slice(Number(params.loc_type));
      },

      _computeDisabled: function (data) {
        return data && !data.length;
      },
    });
  </script>
</dom-module>
