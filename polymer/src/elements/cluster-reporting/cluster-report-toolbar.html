<link rel="import" href="../../../bower_components/polymer/polymer.html">
<link rel="import" href="../../../bower_components/iron-icon/iron-icon.html">
<link rel="import" href="../../../bower_components/iron-icons/iron-icons.html">
<link rel="import" href="../../../bower_components/paper-button/paper-button.html">
<link rel="import" href="../../../bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<link rel="import" href="../../../bower_components/iron-location/iron-query-params.html">

<link rel="import" href="../../endpoints.html">
<link rel="import" href="../../redux/store.html">
<link rel="import" href="../../styles/buttons.html">

<dom-module id="cluster-report-toolbar">
  <template>
    <style include="iron-flex iron-flex-reverse button-styles">
      :host {
        display: block;
        margin: 1em 0;
      }

      a {
        text-decoration: none;
        color: var(--theme-primary-color);
      }
    </style>

    <iron-query-params
        params-string="{{query}}"
        params-object="{{params}}">
    </iron-query-params>

    <div class="layout horizontal-reverse">
      <!-- <paper-button class="btn-primary">
        <iron-icon icon="icons:file-upload"></iron-icon>
        Import
      </paper-button> -->

      <a
          href="[[exportUrl]]"
          tabindex="-1"
          target="_blank">
        <paper-button class="btn-primary">
          <iron-icon icon="icons:file-download"></iron-icon>
          Export
        </paper-button>
      </a>

      <a
          href="[[importTemplateUrl]]"
          tabindex="-1"
          target="_blank">
        <paper-button class="btn-primary">
          <iron-icon icon="icons:file-download"></iron-icon>
          Import Template
        </paper-button>
      </a>
    </div>
  </template>

    <script>
      Polymer({
        is: 'cluster-report-toolbar',

        behaviors: [
          App.Behaviors.ReduxBehavior,
        ],

        properties: {
          query: String,
          params: Object,

          responsePlanId: {
            type: String,
            statePath: 'responsePlans.currentID',
          },

          importTemplateUrl: {
            type: String,
            computed: '_computeImportTemplateUrl(responsePlanId, query)',
          },

          exportUrl: {
            type: String,
            computed: '_computeExportUrl(responsePlanId, query)',
          },
        },

        _computeImportTemplateUrl: function (responsePlanId, query) {
          return [
            App.Endpoints.clusterIndicatorReportsImportTemplate(responsePlanId),
            '?',
            query,
          ].join('');
        },

        _computeExportUrl: function (responsePlanId, query) {
          return [
            App.Endpoints.clusterIndicatorReportsExport(responsePlanId),
            '?',
            query,
          ].join('');
        },
      });
    </script>
  </dom-module>
